---
localization_priority: Normal
description: Learn about the actions that are available for mail flow rules in Exchange Online and Exchange Online Protection.
ms.topic: article
author: msdmaguire
ms.author: jhendr
ms.assetid: a5dfe768-fe26-4290-a801-84b3499f1bc4
ms.reviewer: 
f1.keywords:
- NOCSH
title: Mail flow rule actions in Exchange Online
ms.collection: 
- exchange-online
- M365-email-calendar
audience: ITPro
ms.service: exchange-online
manager: serdars

---

# Mail flow rule actions in Exchange Online

In Exchange Online organizations or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, actions in mail flow rules (also known as transport rules) specify what you want to do to messages that match conditions of the rule. For example, you can create a rule that forwards message from specific senders to a moderator, or adds a disclaimer or personalized signature to all outbound messages.

Actions typically require additional properties. For example, when the rule redirects a message, you need to specify where to redirect the message. Some actions have multiple properties that are available or required. For example, when the rule adds a header field to the message header, you need to specify both the name and value of the header. When the rule adds a disclaimer to messages, you need to specify the disclaimer text, but you can also specify where to insert the text, or what to do if the disclaimer can't be added to the message. Typically, you can configure multiple actions in a rule, but some actions are exclusive. For example, one rule can't reject and redirect the same message.

For more information about mail flow rules, including how multiple actions are handled, see [Mail flow rules (transport rules) in Exchange Online](mail-flow-rules.md).

For more information about conditions and exceptions in mail flow rules, see [Mail flow rule conditions and exceptions (predicates) in Exchange Online](conditions-and-exceptions.md).

For more information about actions in mail flow rules in Exchange Server, see or [Mail flow rule actions in Exchange Server](../../../ExchangeServer/policy-and-compliance/mail-flow-rules/actions.md).

## Actions for mail flow rules in Exchange Online

The actions that are available in mail flow rules in Exchange Online and standalone EOP are described in the following table. Valid values for each property are described in the [Property values](#property-values) section.

**Notes**:

- After you select an action in the Exchange admin center (EAC), the value that's ultimately shown in the **Do the following** field is often different from the click path you selected. Also, when you create new rules, you can sometimes (depending on the selections you make) select a short action name from a template (a filtered list of actions) instead of following the complete click path. The short names and full click path values are shown in the EAC column in the table.

- The names of some of the actions that are returned by the **Get-TransportRuleAction** cmdlet are different than the corresponding parameter names, and multiple parameters might be required for an action.

<br>

****

|Action in the EAC|Action parameter in PowerShell|Property|Description|
|---|---|---|---|
|**Forward the message for approval to** <p> **Forward the message for approval** \> **to these people**|_ModerateMessageByUser_|`Addresses`|Forwards the message to the specified moderators as an attachment wrapped in an approval request. For more information, see [Use mail flow rules for message approval scenarios in Exchange Online](common-message-approval-scenarios.md). You can't use a distribution group as a moderator. <p> **Note**: This action isn't available in standalone Exchange Online Protection (EOP) environments.|
|**Forward the message for approval to the sender's manager** <p> **Forward the message for approval** \> **to the sender's manager**|_ModerateMessageByManager_|n/a|Forwards the message to the sender's manager for approval. <p> This action only works if the sender's **Manager** attribute is defined. Otherwise, the message is delivered to the recipients without moderation. <p>**Note**: This action isn't available in standalone EOP environments.|
|**Redirect the message to** <p> **Redirect the message to** \> **these recipients**|_RedirectMessageTo_|`Addresses`|Redirects the message to the specified recipients. The message isn't delivered to the original recipients, and no notification is sent to the sender or the original recipients.|
|**Deliver the message to the hosted quarantine** <p> **Redirect the message to** \> **hosted quarantine**|_Quarantine_|n/a|Delivers the message to the quarantine in EOP. For more information, see [Quarantined email messages in EOP](/microsoft-365/security/office-365-security/quarantine-email-messages).|
|**Use the following connector** <p> **Redirect the message to** \> **the following connector**|_RouteMessageOutboundConnector_|`OutboundConnector`|Uses the specified outbound connector to deliver the message. For more information about connectors, see [Configure mail flow using connectors](../../mail-flow-best-practices/use-connectors-to-configure-mail-flow/use-connectors-to-configure-mail-flow.md).|
|**Reject the message with the explanation** <p> **Block the message** \> **reject the message and include an explanation**|_RejectMessageReasonText_|`String`|Returns the message to the sender in a non-delivery report (also known as an NDR or bounce message) with the specified text as the rejection reason. The recipient doesn't receive the original message or notification. <p> The default enhanced status code that's used is `5.7.1`. <p> When you create or modify the rule in PowerShell, you can specify the DSN code by using the _RejectMessageEnhancedStatusCode_ parameter.|
|**Reject the message with the enhanced status code** <p> **Block the message** \> **reject the message with the enhanced status code of**|_RejectMessageEnhancedStatusCode_|`DSNEnhancedStatusCode`|Returns the message to the sender in an NDR with the specified enhanced delivery status notification (DSN) code. The recipient doesn't receive the original message or notification. <p> Valid DSN codes are `5.7.1` or `5.7.900` through `5.7.999`. <p> The default reason text that's used is `Delivery not authorized, message refused`. <p> When you create or modify the rule in PowerShell, you can specify the rejection reason text by using the _RejectMessageReasonText_ parameter.|
|**Delete the message without notifying anyone** <p> **Block the message** \> **delete the message without notifying anyone**|_DeleteMessage_|n/a|Silently drops the message without sending a notification to the recipient or the sender.|
|**Add recipients to the Bcc box** <p> **Add recipients** \> **to the Bcc box**|_BlindCopyTo_|`Addresses`|Adds one or more recipients to the **Bcc** field of the message. The original recipients aren't notified, and they can't see the additional addresses. <p> **Note**: In Exchange Online, you can't add a distribution group as a recipient.|
|**Add recipients to the To box** <p> **Add recipients** \> **to the To box**|_AddToRecipients_|`Addresses`|Adds one or more recipients to the **To** field of the message. The original recipients can see the additional addresses. <p> **Note**: In Exchange Online, you can't add a distribution group as a recipient.|
|**Add recipients to the Cc box** <p> **Add recipients** \> **to the Cc box**|_CopyTo_|`Addresses`|Adds one or more recipients to the **Cc** field of the message. The original recipients can see the additional address. <p> **Note**: In Exchange Online, you can't add a distribution group as a recipient.|
|**Add the sender's manager as a recipient** <p> **Add recipients** \> **add the sender's manager as a recipient**|_AddManagerAsRecipientType_|`AddedManagerAction`|Adds the sender's manager to the message as the specified recipient type (**To**, **Cc**, **Bcc**), or redirects the message to the sender's manager without notifying the sender or the recipient. <p> This action only works if the sender's **Manager** attribute is defined in Active Directory.|
|**Append the disclaimer** <p> **Apply a disclaimer to the message** \> **append a disclaimer**|_ApplyHtmlDisclaimerText_ <br/> _ApplyHtmlDisclaimerFallbackAction_ <br/> _ApplyHtmlDisclaimerLocation_|First property: `DisclaimerText` <br/> Second property: `DisclaimerFallbackAction` <br/> Third property (PowerShell only): `DisclaimerTextLocation`|Applies the specified HTML disclaimer to the end of the message. <br/> When you create or modify the rule in PowerShell, use the _ApplyHtmlDisclaimerLocation_ parameter with the value `Append`.|
|**Prepend the disclaimer** <p> **Apply a disclaimer to the message** \> **prepend a disclaimer**|_ApplyHtmlDisclaimerText_ <br/> _ApplyHtmlDisclaimerFallbackAction_ <br/> _ApplyHtmlDisclaimerLocation_|First property: `DisclaimerText` <br/> Second property: `DisclaimerFallbackAction` <br/> Third property (PowerShell only): `DisclaimerTextLocation`|Applies the specified HTML disclaimer to the beginning of the message. <br/> When you create or modify the rule in PowerShell, use the _ApplyHtmlDisclaimerLocation_ parameter with the value `Prepend`.|
|**Remove this header** <p> **Modify the message properties** \> **remove a message header**|_RemoveHeader_|`MessageHeaderField`|Removes the specified header field from the message header.|
|**Set the message header to this value** <p> **Modify the message properties** \> **set a message header**|_SetHeaderName_ <br/> _SetHeaderValue_|First property: `MessageHeaderField` <br/> Second property: `String`|Adds or modifies the specified header field in the message header, and sets the header field to the specified value.|
|**Apply a message classification** <p> **Modify the message properties** \> **apply a message classification**|_ApplyClassification_|`MessageClassification`|Applies the specified message classification to the message. <p>**Note**: This action isn't available in standalone EOP environments.|
|**Set the spam confidence level (SCL) to** <p> **Modify the message properties** \> **set the spam confidence level (SCL)**|_SetSCL_|`SCLValue`|Sets the spam confidence level (SCL) of the message to the specified value.|
|**Apply Office 365 Message Encryption and rights protection** <p> **Apply Message Encryption and rights protection to the message with** <p> **Modify the message security** \> **Message Encryption and rights protection**|_ApplyRightsProtectionTemplate_|`RMSTemplate`|Applies the specified Azure Rights Management (Azure RMS) template to the message. Azure RMS is part of Azure Information Protection. For more information, see [Set up new Message Encryption capabilities](/microsoft-365/compliance/set-up-new-message-encryption-capabilities).|
|**Require TLS encryption** <p> **Modify the message security** \> **require TLS encryption**|_RouteMessageOutboundRequireTls_|n/a|Forces the outbound messages to be routed over a TLS encrypted connection.|
|**Encrypt the messages with the previous version of OME** <p> **Modify the message security** \> **Apply Office the previous version of OME**|_ApplyOME_|n/a|If you haven't moved your Microsoft 365 or Office 365 organization to Office 365 Message Encryption (OME) that's built on Azure Information Protection, this action encrypts the message and attachments with the previous version of OME. <p> **Notes**: <ul><li>We recommend that you make a plan to move to OME on Azure Information Protection as soon as it's reasonable for your organization. For instructions, see [Set up new Message Encryption capabilities](/microsoft-365/compliance/set-up-new-message-encryption-capabilitiess).</li><li>If you receive an error stating that IRM licensing isn't enabled, you can't setup the previous version of OME. If you setup OME now, you'll setup the OME capabilities that are built on Azure Information Protection.</li><ul>|
|**Remove the previous version of OME from the message** <p> **Modify the message security** \> **Remove the previous version of OME**|_RemoveOME_|n/a|Decrypt the message and attachments from the previous version of OME so users don't need to sign in to the encryption portal in order to view them. This action is only available for messages that are sent within your organization.|
|**Remove Office 365 Message Encryption and rights protection** <p> **Modify the message security** \> **Message Encryption and rights protection**|_RemoveOMEv2_|n/a|Remove the Azure RMS template from the message.|
|**Prepend the subject of the message with**|_PrependSubject_|`String`|Adds the specified text to the beginning of the **Subject** field of the message. Consider using a space or a colon (:) as the last character of the specified text to differentiate it from the original subject text. <br/> To prevent the same string from being added to messages that already contain the text in the subject (for example, replies), add the **The subject includes** (_ExceptIfSubjectContainsWords_) exception to the rule.|
|**Notify the sender with a Policy Tip**|_NotifySender_ <br/> _RejectMessageReasonText_ <br/> _RejectMessageEnhancedStatusCode_ (PowerShell only)|First property: `NotifySenderType` <br/> Second property: `String` <br/> Third property (PowerShell only): `DSNEnhancedStatusCode`|Notifies the sender or blocks the message when the message matches a DLP policy. <p> When you use this action, you need to use the **The message contains sensitive information** (_MessageContainsDataClassification_ condition. <p> When you create or modify the rule in PowerShell, the _RejectMessageReasonText_ parameter is optional. If you don't use this parameter, the default text `Delivery not authorized, message refused` is used. <p> In PowerShell, you can also use the _RejectMessageEnhancedStatusCode_ parameter to specify the enhanced status code. If you don't use this parameter, the default enhanced status code `5.7.1` is used. p> This action limits the other conditions, exceptions, and actions that you can configure in the rule. <p>**Note**: This action isn't available in standalone EOP environments.|
|**Generate incident report and send it to**|_GenerateIncidentReport_ <br/> _IncidentReportContent_|First property: `Addresses` <br/> Second property: `IncidentReportContent`|Sends an incident report that contains the specified content to the specified recipients. <p> An incident report is generated for messages that match data loss prevention (DLP) policies in your organization.|
|**Notify the recipient with a message**|_GenerateNotification_|`NotificationMessageText`|Specifies the text, HTML tags, and message keywords to include in the notification message that's sent to the message's recipients. For example, you can notify recipients that the message was rejected by the rule, or marked as spam and delivered to their Junk Email folder.|
|**Properties of this rule** section \> **Audit this rule with severity level**|_SetAuditSeverity_|`AuditSeverityLevel`|Specifies whether to: <ul><li>Prevent the generation of an incident report and the corresponding entry in the message tracking log.</li><li>Generate an incident report and the corresponding entry in the message tracking log with the specified severity level (low, medium, or high).</li></ul>|
|**Properties of this rule** section \> **Stop processing more rules** <p> **More options** \> **Properties of this rule** section \> **Stop processing more rules**|_StopRuleProcessing_|n/a|Specifies that after the message is affected by the rule, the message is exempt from processing by other rules.|
|

## Property values

The property values that are used for actions in mail flow rules are described in the following table.

<br>

****

|Property|Valid values|Description|
|---|---|---|
|`AddedManagerAction`|One of the following values: <ul><li>**To**</li><li>**Cc**</li><li>**Bcc**</li><li>**Redirect**</li></ul>|Specifies how to include the sender's manager in messages. <p> If you select **To**, **Cc**, or **Bcc**, the sender's manager is added as a recipient in the specified field. <p> If you select **Redirect**, the message is only delivered to the sender's manager without notifying the sender or the recipient. <p> This action only works if the sender's **Manager** is defined.|
|`Addresses`|Exchange recipients|Depending on the action, you might be able to specify any mail-enabled object in the organization, or you might be limited to a specific object type. Typically, you can select multiple recipients, but you can only send an incident report to one recipient.|
|`AuditSeverityLevel`|One of the following values: <ul><li>Uncheck **Audit this rule with severity level**, or select **Audit this rule with severity level** with the value **Not specified** (`DoNotAudit`)</li><li>**Low**</li><li>**Medium**</li><li>**High**</li></ul>|The values **Low**, **Medium**, or **High** specify the severity level that's assigned to the incident report and to the corresponding entry in the message tracking log. <p> The other value prevents an incident report from being generated, and prevents the corresponding entry from being written to the message tracking log.|
|`DisclaimerFallbackAction`|One of the following values: <ul><li>**Wrap**</li><li>**Ignore**</li><li>**Reject**</li></ul>|Specifies what to do if the disclaimer can't be applied to a message. When a message is encrypted or signed, the contents can't be altered. The available fallback actions are: <ul><li>**Wrap**: The original message is wrapped in a new message envelope, and the disclaimer text is inserted into the new message. This is the default value.</li><li>**Ignore**: The rule is ignored and the message is delivered without the disclaimer</li><li>**Reject**: The message is returned to the sender in an NDR.</li></ul> <p> **Notes**: <ul><li>Subsequent mail flow rules are applied to the new message envelope, not to the original message. Therefore, configure these rules with a lower priority than other rules.</li><li> If the original message can't be wrapped in a new message envelope, the original message isn't delivered. The message is returned to the sender in an NDR.</li></ul>|
|`DisclaimerText`|HTML string|Specifies the disclaimer text, which can include HTML tags, inline cascading style sheet (CSS) tags, and images by using the IMG tag. The maximum length is 5000 characters, including tags.|
|`DisclaimerTextLocation`|Single value: `Append` or `Prepend`|In PowerShell, you use the _ApplyHtmlDisclaimerLocation_ to specify the location of the disclaimer text in the message: <ul><li>`Append`: Add the disclaimer to the end of the message body. This is the default value.</li><li>`Prepend`: Add the disclaimer to the beginning of the message body.</li></ul>|
|`DSNEnhancedStatusCode`|Single DSN code value: <ul><li>`5.7.1`</li><li>`5.7.900` through `5.7.999`</li></ul>|Specifies the DSN code that's used. You can create custom DSNs by using the **New-SystemMessage** cmdlet. <p> If you don't specify the rejection reason text along with the DSN code, the default reason text that's used is `Delivery not authorized, message refused`. <p> When you create or modify the rule in PowerShell, you can specify the rejection reason text by using the _RejectMessageReasonText_ parameter.|
|`IncidentReportContent`|One or more of the following values: <ul><li>**Sender**</li><li>**Recipients**</li><li>**Subject**</li><li>**Cc'd recipients** (`Cc`)</li><li>**Bcc'd recipients** (`Bcc`)</li><li>**Severity**</li><li>**Sender override information** (`Override`)</li><li>**Matching rules** (`RuleDetections`)</li><li>**False positive reports** (`FalsePositive`)</li><li>**Detected data classifications** (`DataClassifications`)</li><li>**Matching content** (`IdMatch`)</li><li>**Original mail** (`AttachOriginalMail`)</li></ul>|Specifies the original message properties to include in the incident report. You can choose to include any combination of these properties. In addition to the properties you specify, the message ID is always included. The available properties are: <ul><li>**Sender**: The sender of the original message.</li><li>**Recipients**, **Cc'd recipients**, and **Bcc'd recipients**: All recipients of the message, or only the recipients in the **Cc** or **Bcc** fields. For each property, only the first 10 recipients are included in the incident report.</li><li>**Subject**: The **Subject** field of the original message.</li><li>**Severity**: The audit severity of the rule that was triggered. Message tracking logs include all the audit severity levels, and can be filtered by audit severity. <p> In the EAC, if you clear the **Audit this rule with severity level** check box (in PowerShell, the _SetAuditSeverity_ parameter value `DoNotAudit`), rule matches won't appear in the rule reports. <p> If a message is processed by more than one rule, the highest severity is included in any incident reports.</li><li>**Sender override information**: The override if the sender chose to override a Policy Tip. If the sender provided a justification, the first 100 characters of the justification are also included.</li><li>**Matching rules**: The list of rules that the message triggered.</li><li>**False positive reports**: The false positive if the sender marked the message as a false positive for a Policy Tip.</li><li>**Detected data classifications**: The list of sensitive information types detected in the message.</li><li>**Matching content**: The sensitive information type detected, the exact matched content from the message, and the 150 characters before and after the matched sensitive information.</li><li>**Original mail**: The entire message that triggered the rule is attached to the incident report. <p> In PowerShell, you specify multiple values separated by commas.</li></ul>|
|`MessageClassification`|Single message classification object|In the EAC, you select from the list of available message classifications. <p> In PowerShell, use the **Get-MessageClassification** cmdlet to see the message classification objects that are available.|
|`MessageHeaderField`|Single string|Specifies the SMTP message header field to add, remove, or modify. <p> The message header is a collection of required and optional header fields in the message. Examples of header fields are **To**, **From**, **Received**, and **Content-Type**. Official header fields are defined in RFC 5322. Unofficial header fields start with **X-** and are known as X-headers.|
|`NotificationMessageText`|Any combination of plain text, HTML tags, and keywords|Specified the text to use in a recipient notification message. <p> In addition to plain text and HTML tags, you can specify the following keywords that use values from the original message: <ul><li>`%%From%%`</li><li>`%%To%%`</li><li>`%%Cc%%`</li><li>`%%Subject%%`</li><li>`%%Headers%%`</li><li>`%%MessageDate%%`</li></ul>|
|`NotifySenderType`|One of the following values: <ul><li>**Notify the sender, but allow them to send** (`NotifyOnly`)</li><li>**Block the message** (`RejectMessage`)</li><li>**Block the message unless it's a false positive** (`RejectUnlessFalsePositiveOverride`)</li><li>**Block the message, but allow the sender to override and send** (`RejectUnlessSilentOverride`)</li><li>**Block the message, but allow the sender to override with a business justification and send** (`RejectUnlessExplicitOverride`)</li></ul>|Specifies the type of Policy Tip that the sender receives if the message violates a DLP policy. The settings are described in the following list: <ul><li>**Notify the sender, but allow them to send**: The sender is notified, but the message is delivered normally.</li><li>**Block the message**: The message is rejected, and the sender is notified.</li><li>**Block the message unless it's a false positive**: The message is rejected unless it's marked as a false positive by the sender.</li><li>**Block the message, but allow the sender to override and send**: The message is rejected unless the sender has chosen to override the policy restriction.</li><li>**Block the message, but allow the sender to override with a business justification and send**: This is similar to **Block the message, but allow the sender to override and send** type, but the sender also provides a justification for overriding the policy restriction.</li></ul> <p> When you use this action, you need to use the **The message contains sensitive information** (_MessageContainsDataClassification_) condition.|
|`OutboundConnector`|Single outbound connector|Specifies the identity of outbound connector that's used to deliver messages. For more information about connectors, see [Configure mail flow using connectors](../../mail-flow-best-practices/use-connectors-to-configure-mail-flow/use-connectors-to-configure-mail-flow.md). <p> In the EAC, you select the connector from a list. <p> In PowerShell, use the **Get-OutboundConnector** cmdlet to see the connectors that are available.|
|`RMSTemplate`|Single Azure RMS template object|Specifies the Azure Rights Management (Azure RMS) template that's applied to the message. <p> In the EAC, you select the RMS template from a list. <p> In PowerShell, use the **Get-RMSTemplate** cmdlet to see the RMS templates that are available. <p> For more information about RMS in Microsoft 365 or Office 365, see [What is Azure Information Protection?](/azure/information-protection/what-is-information-protection).|
|`SCLValue`|One of the following values: <ul><li>**Bypass spam filtering** (`-1`)</li><li>Integers 0 through 9</li></ul>|Specifies the spam confidence level (SCL) that's assigned to the message. A higher SCL value indicates that a message is more likely to be spam.|
|`String`|Single string|Specifies the text that's applied to the specified message header field, NDR, or event log entry. <p> In PowerShell, if the value contains spaces, enclose the value in quotation marks (").|
|

## For more information

[Mail flow rules (transport rules) in Exchange Online](mail-flow-rules.md)

[Mail flow rule conditions and exceptions (predicates) in Exchange Online](conditions-and-exceptions.md)

[Mail flow rule procedures in Exchange Online](mail-flow-rule-procedures.md)
